var Engine=function(_,$,e){let t=[0,0,0,0,0,0,0,0,1],r=6,n=1,o=2,i=8,f=[0,6,n,o,3,4,5,0,0,12,7,i,9,10,11],a=[0,2,3,4,5,6,1,10,11,12,13,14,9],u=["a8","b8","c8","d8","e8","f8","g8","h8","i8","j8","k8","l8","m8","n8","o8","p8","a7","b7","c7","d7","e7","f7","g7","h7","i7","j7","k7","l7","m7","n7","o7","p7","a6","b6","c6","d6","e6","f6","g6","h6","i6","j6","k6","l6","m6","n6","o6","p6","a5","b5","c5","d5","e5","f5","g5","h5","i5","j5","k5","l5","m5","n5","o5","p5","a4","b4","c4","d4","e4","f4","g4","h4","i4","j4","k4","l4","m4","n4","o4","p4","a3","b3","c3","d3","e3","f3","g3","h3","i3","j3","k3","l3","m3","n3","o3","p3","a2","b2","c2","d2","e2","f2","g2","h2","i2","j2","k2","l2","m2","n2","o2","p2","a1","b1","c1","d1","e1","f1","g1","h1","i1","j1","k1","l1","m1","n1","o1","p1",];var c,l,s=[10,i,9,11,12,9,i,10,13,13,13,13,13,13,13,13,7,7,7,7,7,7,7,7,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,n,n,n,n,n,n,n,n,13,13,13,13,13,13,13,13,4,o,3,5,6,3,o,4,13,13,13,13,13,13,13,13,],h=0,p=120,v=15,d=0,g=0,m=[116,4],b={[n]:0,[o]:0,3:0,4:0,5:0,6:0,7:0,[i]:0,9:0,10:0,11:0,12:0,pieces:Array(130)},C=[],k=0,A=0,x=1804289383;function E(){var _=x;return _^=_<<13,_^=_>>17,_^=_<<5,x=_,_}var T=Array(1664),B=Array(16);function K(){for(var _=0,$=0;$<128;$++)if((136&$)==0){var e=s[$];0!=e&&(_^=T[128*e+$])}return 0==h&&(_^=c),120!=p&&(_^=T[p]),_^=B[v]}function P(){for(var _=n;_<=12;_++)b[_]=0;for(var $=0;$<b.pieces.length;$++)b.pieces[$]=0;for(var e=0;e<128;e++)if((136&e)==0){var _=s[e];_&&(b.pieces[10*_+b[_]]=e,b[_]++)}}var S=[16,-16,1,-1,15,17,-15,-17];let w=[[],S,[],[33,31,18,14,-33,-31,-18,-14],[15,17,-15,-17],[16,-16,1,-1],S];function H(_,$){for(let e=r;e>=1;e--){let t=e|$<<3;if(2==e){let n=16*(1-2*$);for(let o=-1;o<=1;o+=2){let i=_+n+o;if(!(136&i)&&s[i]==f[t])return!0}}else{let a=4&e,u=w[e];for(let c=0;c<u.length;c++){let l=_;do{if(136&(l+=u[c]))break;let h=s[l];if(0!=h){if(h==f[t])return!0;break}}while(a)}}}return!1}function M(_,$,e,t,r,n,o){return _|$<<7|e<<14|t<<18|r<<19|n<<20|o<<21}function I(_){return 127&_}function N(_){return _>>7&127}function F(_){return _>>14&15}function D(_){return _>>18&1}function G(_){return _>>19&1}function q(_){return _>>20&1}function y(_){return _>>21&1}let L=[96,16],O=[0,112],R=[[1,2],[4,8],],Q=[7,15,15,15,3,15,15,11,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,13,15,15,15,12,15,15,14,13,13,13,13,13,13,13,13,];function W(_,$){let e=0;D($)?(e=_2[13*s[I($)]+s[N($)]],e+=1e4):e=_a[k]==$?9e3:_a[_o+k]==$?8e3:_u[128*s[I($)]+N($)],_.push({move:$,score:e})}function j(_){for(let $=n;$<=12;$++)for(let e=0;e<b[$];e++){let o=b.pieces[10*$+e],i=a[s[o]],u=7&i;if(t[8&i]==h){if(2==u){let c=-16*(1-2*h),l=o+c;if((136&l)==0&&0==s[l]){if((240&l)==O[h])for(let d=r;d>=3;d--)W(_,M(o,l,f[d|h<<3],0,0,0,0));else{W(_,M(o,l,0,0,0,0,0));let g=o+2*c;(240&o)==L[h]&&0==s[g]&&W(_,M(o,g,0,0,1,0,0))}}for(let C=-1;C<=1;C+=2){if(136&(l=o+c+C))continue;let k=a[s[l]];if(0!=k&&t[8&k]!=h){if((240&l)==O[h])for(let A=r;A>=3;A--)W(_,M(o,l,f[A|h<<3],1,0,0,0));else W(_,M(o,l,0,1,0,0,0))}l==p&&W(_,M(o,l,0,1,0,1,0))}}else if(1==u){let x=m[h];v&R[h][0]&&0==s[x+1]&&0==s[x+2]&&0==H(x,1-h)&&0==H(x+1,1-h)&&W(_,M(x,x+2,0,0,0,0,1)),v&R[h][1]&&0==s[x-1]&&0==s[x-2]&&0==s[x-3]&&0==H(x,1-h)&&0==H(x-1,1-h)&&W(_,M(x,x-2,0,0,0,0,1))}if(2!=u){let E=4&u,T=w[u];for(let B=0;B<T.length;B++){let K=o;do{if(136&(K+=T[B]))break;let P=a[s[K]];if(0!=P){t[8&P]!=h&&W(_,M(o,K,0,1,0,0,0));break}W(_,M(o,K,0,0,0,0,0))}while(E)}}}}}function z(_,$,e){s[e]=s[$],s[$]=0,g^=T[128*_+$],g^=T[128*_+e];for(let t=0;t<b[_];t++)if(b.pieces[10*_+t]==$){b.pieces[10*_+t]=e;break}}function U(_,$){for(let e=0;e<b[_];e++)if(b.pieces[10*_+e]==$){var t=e;break}b[_]--,b.pieces[10*_+t]=b.pieces[10*_+b[_]]}function V(_,$){s[$]=_,g^=T[128*_+$],b.pieces[10*_+b[_]]=$,b[_]++}function Z(_){k++,_c[++A]=g;let $=I(_),e=N(_),t=F(_),r=s[e];if(C.push({move:_,capturedPiece:0,side:h,enpassant:p,castle:v,fifty:d,hash:g}),z(s[$],$,e),d++,D(_)?(r&&(C[C.length-1].capturedPiece=r,g^=T[128*r+e],U(r,e)),d=0):(s[e]==n||7==s[e])&&(d=0),120!=p&&(g^=T[p]),p=120,G(_))0==h?(p=e+16,g^=T[e+16]):(p=e-16,g^=T[e-16]);else if(q(_))0==h?(s[e+16]=0,g^=T[896+e+16],U(7,e+16)):(s[e-16]=0,g^=T[128*n+(e-16)],U(n,e-16));else if(y(_))switch(e){case 118:z(4,119,117);break;case 114:z(4,112,115);break;case 6:z(10,7,5);break;case 2:z(10,0,3)}return(t&&(0==h?(g^=T[128*n+e],U(n,e)):(g^=T[896+e],U(7,e)),V(t,e)),(6==s[e]||12==s[e])&&(m[h]=e),g^=B[v],v&=Q[$],v&=Q[e],g^=B[v],h^=1,g^=c,H(m[1^h],h))?(J(),0):1}function J(){k--,A--;let _=C.length-1,$=C[_].move,e=I($),t=N($);if(z(s[t],t,e),D($)&&V(C[_].capturedPiece,t),q($))0==h?V(n,t-16):V(7,t+16);else if(y($))switch(t){case 118:z(4,117,119);break;case 114:z(4,115,112);break;case 6:z(10,5,7);break;case 2:z(10,3,0)}else F($)&&(0==h?V(7,e):V(n,e),U(F($),e));(6==s[e]||12==s[e])&&(m[1^h]=e),h=C[_].side,p=C[_].enpassant,v=C[_].castle,g=C[_].hash,d=C[_].fifty,C.pop()}var X=0;function Y(_){if(0==_){X++;return}let $=[];j($);for(var e=0;e<$.length;e++)Z($[e].move)&&(Y(_-1),J())}let __=[[0,89,308,319,488,888,20001,-92,-307,-323,-492,-888,-20002],[0,96,319,331,497,853,19998,-102,-318,-334,-501,-845,-2e4],],_1=[[[0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,-4,68,61,47,47,49,45,-1,13,13,13,13,13,13,13,13,6,16,25,33,24,24,14,-6,13,13,13,13,13,13,13,13,0,-1,9,28,20,8,-1,11,13,13,13,13,13,13,13,13,6,4,6,14,14,-5,6,-6,13,13,13,13,13,13,13,13,-1,-8,-4,4,2,-12,-1,5,13,13,13,13,13,13,13,13,5,16,16,-14,-14,13,15,8,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,],[-55,-40,-30,-28,-26,-30,-40,-50,13,13,13,13,13,13,13,13,-37,-15,0,-6,4,3,-17,-40,13,13,13,13,13,13,13,13,-25,5,16,12,11,6,6,-29,13,13,13,13,13,13,13,13,-24,5,21,14,18,9,11,-26,13,13,13,13,13,13,13,13,-36,-5,9,23,24,21,2,-24,13,13,13,13,13,13,13,13,-32,-1,4,19,20,4,11,-25,13,13,13,13,13,13,13,13,-38,-22,4,-1,8,-5,-18,-34,13,13,13,13,13,13,13,13,-50,-46,-32,-24,-36,-25,-34,-50,13,13,13,13,13,13,13,13,],[-16,-15,-12,-5,-10,-12,-10,-20,13,13,13,13,13,13,13,13,-13,5,6,1,-6,-5,3,-6,13,13,13,13,13,13,13,13,-16,6,-1,16,7,-1,-6,-5,13,13,13,13,13,13,13,13,-14,-1,11,14,4,10,11,-13,13,13,13,13,13,13,13,13,-4,5,12,16,4,6,2,-16,13,13,13,13,13,13,13,13,-15,4,14,8,16,4,16,-15,13,13,13,13,13,13,13,13,-5,6,6,6,3,6,9,-7,13,13,13,13,13,13,13,13,-14,-4,-15,-4,-9,-4,-12,-14,13,13,13,13,13,13,13,13,],[5,-2,6,2,-2,-6,4,-2,13,13,13,13,13,13,13,13,8,13,11,15,11,15,16,4,13,13,13,13,13,13,13,13,-6,3,3,6,1,-2,3,-5,13,13,13,13,13,13,13,13,-10,5,-4,-4,-1,-6,3,-2,13,13,13,13,13,13,13,13,-4,3,5,-2,4,1,-5,1,13,13,13,13,13,13,13,13,0,1,1,-3,5,6,1,-9,13,13,13,13,13,13,13,13,-10,-1,-4,0,5,-6,-6,-9,13,13,13,13,13,13,13,13,-1,-2,-6,9,9,5,4,-5,13,13,13,13,13,13,13,13,],[-25,-9,-11,-3,-7,-13,-10,-17,13,13,13,13,13,13,13,13,-4,-6,4,-5,-1,6,4,-5,13,13,13,13,13,13,13,13,-8,-5,2,0,7,6,-4,-5,13,13,13,13,13,13,13,13,0,-4,7,-1,7,11,0,1,13,13,13,13,13,13,13,13,-6,4,7,1,-1,2,-6,-2,13,13,13,13,13,13,13,13,-15,11,11,11,4,11,6,-15,13,13,13,13,13,13,13,13,-5,-6,1,-6,3,-3,3,-10,13,13,13,13,13,13,13,13,-15,-4,-13,-8,-3,-16,-8,-24,13,13,13,13,13,13,13,13,],[-30,-40,-40,-50,-50,-40,-40,-30,13,13,13,13,13,13,13,13,-30,-37,-43,-49,-50,-39,-40,-30,13,13,13,13,13,13,13,13,-32,-41,-40,-46,-49,-40,-46,-30,13,13,13,13,13,13,13,13,-32,-38,-39,-52,-54,-39,-39,-30,13,13,13,13,13,13,13,13,-20,-33,-29,-42,-44,-29,-30,-19,13,13,13,13,13,13,13,13,-10,-18,-17,-20,-22,-21,-20,-13,13,13,13,13,13,13,13,13,14,18,-1,-1,4,-1,15,14,13,13,13,13,13,13,13,13,21,35,11,6,1,14,32,22,13,13,13,13,13,13,13,13,],],[[0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,-4,174,120,94,85,98,68,4,13,13,13,13,13,13,13,13,6,48,44,45,31,38,37,-6,13,13,13,13,13,13,13,13,-6,-4,-1,-6,2,-1,-2,-2,13,13,13,13,13,13,13,13,2,2,5,-3,0,-5,4,-3,13,13,13,13,13,13,13,13,-2,0,1,5,0,-1,0,1,13,13,13,13,13,13,13,13,-2,5,6,-6,0,3,4,-4,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,],[-50,-40,-30,-24,-24,-35,-40,-50,13,13,13,13,13,13,13,13,-38,-17,6,-5,5,-4,-15,-40,13,13,13,13,13,13,13,13,-24,3,15,9,15,10,-6,-26,13,13,13,13,13,13,13,13,-29,5,21,17,18,9,10,-28,13,13,13,13,13,13,13,13,-36,-5,18,16,14,20,5,-26,13,13,13,13,13,13,13,13,-32,7,5,20,11,15,9,-27,13,13,13,13,13,13,13,13,-43,-20,5,-1,5,1,-22,-40,13,13,13,13,13,13,13,13,-50,-40,-32,-27,-30,-25,-35,-50,13,13,13,13,13,13,13,13,],[-14,-13,-4,-7,-14,-9,-16,-20,13,13,13,13,13,13,13,13,-11,6,3,-6,4,-3,5,-4,13,13,13,13,13,13,13,13,-11,-3,5,15,4,-1,-5,-10,13,13,13,13,13,13,13,13,-7,-1,11,16,5,11,7,-13,13,13,13,13,13,13,13,13,-4,4,10,16,6,12,4,-16,13,13,13,13,13,13,13,13,-4,4,11,12,10,7,7,-12,13,13,13,13,13,13,13,13,-11,7,6,6,-3,2,1,-7,13,13,13,13,13,13,13,13,-15,-4,-11,-4,-10,-10,-6,-17,13,13,13,13,13,13,13,13,],[5,-6,1,-4,-4,-6,6,-3,13,13,13,13,13,13,13,13,-6,4,2,5,-1,3,4,-15,13,13,13,13,13,13,13,13,-15,3,3,0,-1,-6,5,-9,13,13,13,13,13,13,13,13,-16,6,0,-6,-3,-3,-4,-4,13,13,13,13,13,13,13,13,-15,6,2,-6,6,0,-6,-10,13,13,13,13,13,13,13,13,-6,-1,3,-2,6,5,0,-15,13,13,13,13,13,13,13,13,-8,-4,1,-4,3,-5,-6,-5,13,13,13,13,13,13,13,13,1,0,-2,1,1,4,2,0,13,13,13,13,13,13,13,13,],[-21,-7,-6,1,-8,-15,-10,-16,13,13,13,13,13,13,13,13,-4,-5,3,-4,2,6,3,-10,13,13,13,13,13,13,13,13,-13,-2,7,2,6,10,-4,-6,13,13,13,13,13,13,13,13,-1,-4,3,1,8,8,-2,-2,13,13,13,13,13,13,13,13,0,6,8,1,-1,1,0,-3,13,13,13,13,13,13,13,13,-11,10,6,3,7,9,4,-10,13,13,13,13,13,13,13,13,-12,-6,5,0,0,-5,4,-10,13,13,13,13,13,13,13,13,-20,-6,-7,-7,-4,-12,-9,-20,13,13,13,13,13,13,13,13,],[-50,-40,-30,-20,-20,-30,-40,-50,13,13,13,13,13,13,13,13,-30,-18,-15,6,3,-6,-24,-30,13,13,13,13,13,13,13,13,-35,-16,20,32,34,14,-11,-30,13,13,13,13,13,13,13,13,-34,-5,24,35,34,35,-16,-35,13,13,13,13,13,13,13,13,-36,-7,31,34,34,34,-12,-31,13,13,13,13,13,13,13,13,-30,-7,14,33,36,16,-13,-33,13,13,13,13,13,13,13,13,-36,-27,5,2,5,-1,-31,-33,13,13,13,13,13,13,13,13,-48,-26,-26,-26,-28,-25,-30,-51,13,13,13,13,13,13,13,13,],],],_$=[112,113,114,115,116,117,118,119,13,13,13,13,13,13,13,13,96,97,98,99,100,101,102,103,13,13,13,13,13,13,13,13,80,81,82,83,84,85,86,87,13,13,13,13,13,13,13,13,64,65,66,67,68,69,70,71,13,13,13,13,13,13,13,13,48,49,50,51,52,53,54,55,13,13,13,13,13,13,13,13,32,33,34,35,36,37,39,40,13,13,13,13,13,13,13,13,16,17,18,19,20,21,22,23,13,13,13,13,13,13,13,13,0,1,2,3,4,5,6,7,13,13,13,13,13,13,13,13,];function _e(){if(0==b[n]&&0==b[7]){if(0==b[4]&&0==b[10]&&0==b[5]&&0==b[11]){if(0==b[3]&&0==b[9]){if(b[o]<3&&b[i]<3)return 1}else if(0==b[o]&&0==b[i]){if(2>Math.abs(b[3]-b[9]))return 1}else if((b[o]<3&&0==b[3]||1==b[3]&&0==b[o])&&(b[i]<3&&0==b[9]||1==b[9]&&0==b[i]))return 1}else if(0==b[5]&&0==b[11]){if(1==b[4]&&1==b[10]){if(b[o]+b[3]<2&&b[i]+b[9]<2)return 1}else if(1==b[4]&&0==b[10]){if(b[o]+b[3]==0&&(b[i]+b[9]==1||b[i]+b[9]==2))return 1}else if(1==b[10]&&0==b[4]&&b[i]+b[9]==0&&(b[o]+b[3]==1||b[o]+b[3]==2))return 1}}return 0}function _t(){if(_e())return 0;let _=function _(){let $=0;for(let e=o;e<=5;e++)$+=b[e]*__[0][e];for(let t=i;t<=11;t++)$+=-(b[t]*__[0][t]);return $}(),$=-1;$=_>5900?0:_<500?1:2;let e=0;var t=0,r=0;for(let f=n;f<=12;f++)for(pieceIndex=0;pieceIndex<b[f];pieceIndex++){let a=b.pieces[10*f+pieceIndex];switch(t+=__[0][f],r+=__[1][f],f){case n:t+=_1[0][0][a],r+=_1[1][0][a];break;case o:t+=_1[0][1][a],r+=_1[1][1][a];break;case 3:t+=_1[0][2][a],r+=_1[1][2][a];break;case 4:t+=_1[0][3][a],r+=_1[1][3][a];break;case 5:t+=_1[0][4][a],r+=_1[1][4][a];break;case 6:t+=_1[0][5][a],r+=_1[1][5][a];break;case 7:t-=_1[0][0][_$[a]],r-=_1[1][0][_$[a]];break;case i:t-=_1[0][1][_$[a]],r-=_1[1][1][_$[a]];break;case 9:t-=_1[0][2][_$[a]],r-=_1[1][2][_$[a]];break;case 10:t-=_1[0][3][_$[a]],r-=_1[1][3][_$[a]];break;case 11:t-=_1[0][4][_$[a]],r-=_1[1][4][_$[a]];break;case 12:t-=_1[0][5][_$[a]],r-=_1[1][5][_$[a]]}}return 2==$?e=(t*_+r*(5900-_))/5900:0==$?e=t:1==$&&(e=r),e=e*(100-d)/100<<0,0==h?e:-e}var _r=838860,_n=[];function _0(){for(var _=0;_<_r;_++)_n[_]={hashKey:0,depth:0,flag:0,score:0,bestMove:0}}function _3(_,$,e,t){var r=_n[(2147483647&g)%_r];_<-_i&&(_-=k),_>_i&&(_+=k),r.hashKey=g,r.score=_,r.flag=t,r.depth=e,r.bestMove=$}let _2=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,105,205,305,405,505,605,105,205,305,405,505,605,0,104,204,304,404,504,604,104,204,304,404,504,604,0,103,203,303,403,503,603,103,203,303,403,503,603,0,102,202,302,402,502,602,102,202,302,402,502,602,0,101,201,301,401,501,601,101,201,301,401,501,601,0,100,200,300,400,500,600,100,200,300,400,500,600,0,105,205,305,405,505,605,105,205,305,405,505,605,0,104,204,304,404,504,604,104,204,304,404,504,604,0,103,203,303,403,503,603,103,203,303,403,503,603,0,102,202,302,402,502,602,102,202,302,402,502,602,0,101,201,301,401,501,601,101,201,301,401,501,601,0,100,200,300,400,500,600,100,200,300,400,500,600,],_o=64,_i=48e3;var _f=Array(_o*_o),_4=Array(_o),_a=Array(2*_o),_u=Array(1664),_c=Array(1e3),_l={timeSet:0,stopTime:0,stopped:0,time:-1};function _6(_){_l=_}function _s(){_l={timeSet:0,stopTime:0,stopped:0,time:-1}}function _5(){X=0,_l.stopped=0,k=0;for(let _=0;_<_f.length;_++)_f[_]=0;for(let $=0;$<_4.length;$++)_4[$]=0;for(let e=0;e<_a.length;e++)_a[e]=0;for(let t=0;t<_u.length;t++)_u[t]=0}function _7(){1==_l.timeSet&&Date.now()>_l.stopTime&&(_l.stopped=1)}function _h(){for(let _=0;_<A;_++)if(_c[_]==g)return 1;return 0}function _p(_,$){for(let e=_+1;e<$.length;e++)if($[_].score<$[e].score){let t=$[_];$[_]=$[e],$[e]=t}}function _v(_,$){for(let e=0;e<_.length;e++)if(_[e].move==$.value){_[e].score=3e4;return}if(k&&l){l=0;for(let t=0;t<_.length;t++)if(_[t].move==_f[k]){l=1,_[t].score=2e4;break}}}function _d(_){_f[64*k+k]=_;for(var $=k+1;$<_4[k+1];$++)_f[64*k+$]=_f[(k+1)*64+$];_4[k]=_4[k+1]}function _g(_,$){if(_4[k]=k,(2047&++X)==0&&(_7(),1==_l.stopped))return 0;if(k>_o-1)return _t();let e=_t();if(e>=$)return $;e>_&&(_=e);var o=[];!function _($){for(let e=n;e<=12;e++)for(let o=0;o<b[e];o++){let i=b.pieces[10*e+o],u=a[s[i]],c=7&u;if(t[8&u]==h){if(2==c){let l=-16*(1-2*h),v=i+l;for(let d=-1;d<=1;d+=2){if(136&(v=i+l+d))continue;let g=a[s[v]];if(0!=g&&t[8&g]!=h){if((240&v)==O[h])for(let m=r;m>=3;m--)W($,M(i,v,f[m|h<<3],1,0,0,0));else W($,M(i,v,0,1,0,0,0))}v==p&&W($,M(i,v,0,1,0,1,0))}}if(2!=c){let C=4&c,k=w[c];for(let A=0;A<k.length;A++){let x=i;do{if(136&(x+=k[A]))break;let E=a[s[x]];if(0!=E){t[8&E]!=h&&W($,M(i,x,0,1,0,0,0));break}}while(C)}}}}}(o),_v(o,{value:0});for(var i=0;i<o.length;i++){_p(i,o);let u=o[i].move;if(0!=Z(u)){var c=-_g(-$,-_);if(J(),1==_l.stopped)return 0;if(c>_&&(_d(u),_=c,c>=$))return $}}return _}function _m(_,$,e,t){_4[k]=k;var r={value:0},i=1;let f=0,a=$-_>1,u=0;if(k&&1e5!=(f=function _($,e,t,r){var n=_n[(2147483647&g)%_r];if(n.hashKey==g){if(n.depth>=r){var o=n.score;if(o<-_i&&(o+=k),o>_i&&(o-=k),0==n.flag)return o;if(1==n.flag&&o<=$)return $;if(2==n.flag&&o>=e)return e}t.value=n.bestMove}return 1e5}(_,$,r,e))&&0==a)return f;if((2047&X)==0&&(_7(),1==_l.stopped)||k&&_h()||d>=100)return 0;if(0==e)return X++,_g(_,$);if(_<-49e3&&(_=-49e3),$>48999&&($=48999),_>=$)return _;let l=0,b=H(m[h],1^h);if(b&&e++,0==b&&0==a){let A=_t();if(e<3&&Math.abs($-1)>-48900){let x=__[0][n]*e;if(A-x>=$)return A-x}if(t){if(k&&e>2&&A>=$){if(C.push({move:0,capturedPiece:0,side:h,enpassant:p,castle:v,fifty:d,hash:g}),120!=p&&(g^=T[p]),p=120,d=0,h^=1,g^=c,f=-_m(-$,-$+1,e-1-2,0),h=C[C.length-1].side,p=C[C.length-1].enpassant,v=C[C.length-1].castle,d=C[C.length-1].fifty,g=C[C.length-1].hash,C.pop(),1==_l.stopped)return 0;if(f>=$)return $}let E;if((f=A+__[0][n])<$&&1==e)return(E=_g(_,$))>f?E:f;if((f+=__[0][n])<$&&e<4&&(E=_g(_,$))<$)return E>f?E:f}let B=[0,__[0][n],__[0][o],__[0][4],];e<4&&Math.abs(_)<_i&&A+B[e]<=_&&(u=1)}let K=0,P=[];j(P),_v(P,r);for(let S=0;S<P.length;S++){_p(S,P);let w=P[S].move;if(0!=Z(w)){if(l++,u&&K&&0==D(w)&&0==F(w)&&0==H(m[h],1^h)){J();continue}if(0==K?f=-_m(-$,-_,e-1,1):(f=0==a&&K>3&&e>2&&0==b&&(I(w)!=I(_a[k])||N(w)!=N(_a[k]))&&(I(w)!=I(_a[_o+k])||N(w)!=N(_a[_o+k]))&&0==D(w)&&0==F(w)?-_m(-_-1,-_,e-2,1):_+1)>_&&(f=-_m(-_-1,-_,e-1,1))>_&&f<$&&(f=-_m(-$,-_,e-1,1)),J(),K++,1==_l.stopped)return 0;if(f>_&&(i=0,r.value=w,_=f,_d(w),0==D(w)&&(_u[128*s[I(w)]+N(w)]+=e),f>=$))return _3($,r.value,e,2),0==D(w)&&(_a[_o+k]=_a[k],_a[k]=w),$}}return 0==l?b?-49e3+k:0:(_3(_,r.value,e,i),_)}var _b={5:"q",4:"r",3:"b",[o]:"n",11:"q",10:"r",9:"b",[i]:"n"},_C={P:n,N:o,B:3,R:4,Q:5,K:6,p:7,n:i,b:9,r:10,q:11,k:12};let _k=[".","♙","♘","♗","♖","♕","♔","♟","♞","♝","♜","♛","♚",];function _A(_){return F(_)?u[I(_)]+u[N(_)]+_b[F(_)]:u[I(_)]+u[N(_)]}function _x(){for(var _="    Material counts:\n\n",$=n;$<=12;$++)_+="    "+_k[$]+": "+b[$]+"\n";console.log(_);for(var e="    Piece list:\n\n",$=n;$<=12;$++)for(var t=0;t<b[$];t++)e+="    "+_k[$]+": "+u[b.pieces[10*$+t]]+"\n"}return!function _(){for(var $=0;$<1664;$++)T[$]=E();for(var $=0;$<16;$++)B[$]=E();c=E()}(),g=K(),P(),_0(),{VERSION:"1.5a",ELO:"1920",START_FEN:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1 ",COLOR:{WHITE:0,BLACK:1},PIECE:{NO_PIECE:0,WHITE_PAWN:n,WHITE_KNIGHT:o,WHITE_BISHOP:3,WHITE_ROOK:4,WHITE_QUEEN:5,WHITE_KING:6,BLACK_PAWN:7,BLACK_KNIGHT:i,BLACK_BISHOP:9,BLACK_ROOK:10,BLACK_QUEEN:11,BLACK_KING:12},SQUARE:{A8:0,B8:1,C8:2,D8:3,E8:4,F8:5,G8:6,H8:7,A7:16,B7:17,C7:18,D7:19,E7:20,F7:21,G7:22,H7:23,A6:32,B6:33,C6:34,D6:35,E6:36,F6:37,G6:39,H6:40,A5:48,B5:49,C5:50,D5:51,E5:52,F5:53,G5:54,H5:55,A4:64,B4:65,C4:66,D4:67,E4:68,F4:69,G4:70,H4:71,A3:80,B3:81,C3:82,D3:83,E3:84,F3:85,G3:86,H3:87,A2:96,B2:97,C2:98,D2:99,E2:100,F2:101,G2:102,H2:103,A1:112,B1:113,C1:114,D1:115,E1:116,F1:117,G1:118,H1:119},perft:function(_){!function _($){X=0,console.log("   Performance test:\n"),resultString="";let e=Date.now(),t=[];j(t);for(var r=0;r<t.length;r++){if(!Z(t[r].move))continue;let n=X;Y($-1),J();let o=X-n;console.log("   move "+(r+1)+(r<9?":  ":": ")+u[I(t[r].move)]+u[N(t[r].move)]+(F(t[r].move)?_b[F(t[r].move)]:" ")+"    nodes: "+o)}resultString+="\n   Depth: "+$,resultString+="\n   Nodes: "+X,resultString+="\n    Time: "+(Date.now()-e)+" ms\n",console.log(resultString)}(_)},squareToString:function(_){return u[_]},promotedToString:function(_){return _b[_]},printBoard:function(){!function _(){for(var $="",e=0;e<8;e++){for(var t=0;t<16;t++){var r=16*e+t;0==t&&($+="   "+(8-e).toString()+" "),(136&r)==0&&($+=_k[s[r]]+" ")}$+="\n"}$+="     a b c d e f g h",$+="\n\n     Side:     "+(0==h?"white":"black"),$+="\n     Castling:  "+(1&v?"K":"-")+(2&v?"Q":"-")+(4&v?"k":"-")+(8&v?"q":"-"),$+="\n     Ep:          "+(120==p?"no":u[p]),$+="\n\n     Key: "+g,$+="\n 50 rule:          "+d,$+="\n   moves:          "+(A%2?Math.round(A/2)-1:Math.round(A/2)),console.log($+"\n"),_0()}()},setBoard:function(_){!function _($){!function _(){for(var $=0;$<8;$++)for(var e=0;e<16;e++){var t=16*$+e;(136&t)==0&&(s[t]=0)}for(let r in h=-1,p=120,v=0,d=0,g=0,m=[0,0],C=[],k=0,A=0,_c)_c[r]=0}();for(var e=0,t=0;t<8;t++)for(var r=0;r<16;r++){var n=16*t+r;if((136&n)==0){if(($[e].charCodeAt()>="a".charCodeAt()&&$[e].charCodeAt()<="z".charCodeAt()||$[e].charCodeAt()>="A".charCodeAt()&&$[e].charCodeAt()<="Z".charCodeAt())&&("K"==$[e]?m[0]=n:"k"==$[e]&&(m[1]=n),s[n]=_C[$[e]],e++),$[e].charCodeAt()>="0".charCodeAt()&&$[e].charCodeAt()<="9".charCodeAt()){var o=$[e]-"0";!s[n]&&r--,r+=o,e++}"/"==$[e]&&e++}}for(h="w"==$[++e]?0:1,e+=2;" "!=$[e];){switch($[e]){case"K":v|=1;break;case"Q":v|=2;break;case"k":v|=4;break;case"q":v|=8}e++}if("-"!=$[++e]){var r=$[e].charCodeAt()-"a".charCodeAt(),t=8-($[e+1].charCodeAt()-"0".charCodeAt());p=16*t+r}else p=120;d=parseInt($.slice(e,$.length-1).split(" ")[1]),A=2*parseInt($.slice(e,$.length+1).split(" ")[2]),g=K(),P()}(_)},generateFen:function(){return function _(){let $=["","P","N","B","R","Q","K","p","n","b","r","q","k",],e="";for(let t=0;t<8;t++){let r=0;for(let n=0;n<16;n++){let o=16*t+n;if((136&o)==0){let i=s[o];0==i&&r++,i&&(e+=(r||"")+$[i],r=0)}}r&&(e+=r),r=0,t<7&&(e+="/")}return e+(" "+(engine.getSide()?"b":"w"))}()},getPiece:function(_){return s[_]},getSide:function(){return h},getFifty:function(){return d},moveFromString:function(_){return function _($){let e=[];j(e);for(var t=$[0].charCodeAt()-"a".charCodeAt()+(8-($[1].charCodeAt()-"0".charCodeAt()))*16,r=$[2].charCodeAt()-"a".charCodeAt()+(8-($[3].charCodeAt()-"0".charCodeAt()))*16,n=0;n<e.length;n++){var f=e[n].move,a=0;if(I(f)==t&&N(f)==r){if(a=F(f)){if((a==o||a==i)&&"n"==$[4])return f;if((3==a||9==a)&&"b"==$[4])return f;if((4==a||10==a)&&"r"==$[4])return f;else if((5==a||11==a)&&"q"==$[4])return f;continue}return f}}return 0}(_)},moveToString:function(_){return _A(_)},moveStack:function(){return C},getMoves:function(){return function _(){let $=[];for(let e=0;e<C.length;e++)$.push(_A(C[e].move));return $}()},pgn:function(){return getGamePgn()},getMoveSource:function(_){return I(_)},getMoveTarget:function(_){return N(_)},getMovePromoted:function(_){return F(_)},getMoveCapture:function(_){return D(_)},getMoveCastling:function(_){return y(_)},generateLegalMoves:function(){return function _(){let $=[],e=[];_5(),j(e);for(let t=0;t<e.length;t++)0!=Z(e[t].move)&&($.push(e[t]),J());return $}()},printMoveList:function(_){!function _($){for(var e="   Move     Capture  Double   Enpass   Castling  Score\n\n",t=0;t<$.length;t++){var r=$[t].move;e+="   "+u[I(r)]+u[N(r)],e+=F(r)?_b[F(r)]:" ",e+="    "+D(r)+"        "+G(r)+"        "+q(r)+"        "+y(r)+"         "+$[t].score+"\n"}e+="\n   Total moves: "+$.length,console.log(e)}(_)},resetTimeControl:function(){_s()},setTimeControl:function(_){var $;_l=$=_},getTimeControl:function(){return JSON.parse(JSON.stringify(_l))},search:function(_){return function _($){let e=Date.now(),t=0,r=0;_5();let n=[];for(let o=1;o<=$&&(r=_f[0],l=1,t=_m(-5e4,5e4,o,1),!(1==_l.stopped||Date.now()>_l.stopTime&&-1!=_l.time));o++){let i="";var f=0;t>=-49e3&&t<=-_i?(i="info score mate "+parseInt(-(t+49e3)/2-1)+" depth "+o+" nodes "+X+" time "+(Date.now()-e)+" pv ",f="M"+Math.abs(parseInt(-(t+49e3)/2-1))):t>=_i&&t<=49e3?(i="info score mate "+parseInt((49e3-t)/2+1)+" depth "+o+" nodes "+X+" time "+(Date.now()-e)+" pv ",f="M"+Math.abs(parseInt((49e3-t)/2+1))):(i="info score cp "+t+" depth "+o+" nodes "+X+" time "+(Date.now()-e)+" pv ",f=-t);for(let a=0;a<_4[0];a++)i+=_A(_f[a])+" ";if(n.push(i),49e3==f&&(f="M1"),i.includes("mate")||i.includes("-49000"))break}return{bestMove:1==_l.stopped?r:_f[0],ucis:n,score:t}}(_)},searchTime:function(_){_s();let $=new Date().getTime();_l.timeSet=1,_l.time=_,_l.stopTime=$+_l.time,engine.search(64)},isMaterialDraw:function(){return _e()},takeBack:function(){C.length&&J()},isRepetition:function(){return _h()},inCheck:function(_){return H(m[_],1^_)},isSquareAttacked:function(_,$){return H(_,$)},setHashSize:function(_){var $;_n=[],($=_)<4&&($=4),$>128&&($=128),_r=parseInt(1048576*$/20),_0(),console.log("Set hash table size to",$,"Mb"),console.log("Hash table initialized with",_r,"entries")}}};"undefined"!=typeof exports&&(exports.Engine=Engine);
