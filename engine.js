var Engine=function(){let _=[0,0,0,0,0,0,0,0,1],$=6,e=1,t=2,n=8,r=[0,6,e,t,3,4,5,0,0,12,7,n,9,10,11],o=[0,2,3,4,5,6,1,10,11,12,13,14,9],i=["a8","b8","c8","d8","e8","f8","g8","h8","i8","j8","k8","l8","m8","n8","o8","p8","a7","b7","c7","d7","e7","f7","g7","h7","i7","j7","k7","l7","m7","n7","o7","p7","a6","b6","c6","d6","e6","f6","g6","h6","i6","j6","k6","l6","m6","n6","o6","p6","a5","b5","c5","d5","e5","f5","g5","h5","i5","j5","k5","l5","m5","n5","o5","p5","a4","b4","c4","d4","e4","f4","g4","h4","i4","j4","k4","l4","m4","n4","o4","p4","a3","b3","c3","d3","e3","f3","g3","h3","i3","j3","k3","l3","m3","n3","o3","p3","a2","b2","c2","d2","e2","f2","g2","h2","i2","j2","k2","l2","m2","n2","o2","p2","a1","b1","c1","d1","e1","f1","g1","h1","i1","j1","k1","l1","m1","n1","o1","p1",];var f,a,u=[10,n,9,11,12,9,n,10,13,13,13,13,13,13,13,13,7,7,7,7,7,7,7,7,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,e,e,e,e,e,e,e,e,13,13,13,13,13,13,13,13,4,t,3,5,6,3,t,4,13,13,13,13,13,13,13,13,],c=0,l=120,s=15,p=0,h=0,v=[116,4],d={[e]:0,[t]:0,3:0,4:0,5:0,6:0,7:0,[n]:0,9:0,10:0,11:0,12:0,pieces:Array(130)},g=[],m=0,b=0,k=1804289383;function C(){var _=k;return _^=_<<13,_^=_>>17,_^=_<<5,k=_,_}var A=Array(1664),x=Array(16);function E(){for(var _=0,$=0;$<128;$++)if((136&$)==0){var e=u[$];0!=e&&(_^=A[128*e+$])}return 0==c&&(_^=f),120!=l&&(_^=A[l]),_^=x[s]}function P(){for(var _=e;_<=12;_++)d[_]=0;for(var $=0;$<d.pieces.length;$++)d.pieces[$]=0;for(var t=0;t<128;t++)if((136&t)==0){var _=u[t];_&&(d.pieces[10*_+d[_]]=t,d[_]++)}}function B(_){let $=[];Q($);for(var e=_[0].charCodeAt()-"a".charCodeAt()+(8-(_[1].charCodeAt()-"0".charCodeAt()))*16,r=_[2].charCodeAt()-"a".charCodeAt()+(8-(_[3].charCodeAt()-"0".charCodeAt()))*16,o=0;o<$.length;o++){var i=$[o].move,f=0;if(H(i)==e&&N(i)==r){if(f=I(i)){if((f==t||f==n)&&"n"==_[4])return i;if((3==f||9==f)&&"b"==_[4])return i;if((4==f||10==f)&&"r"==_[4])return i;else if((5==f||11==f)&&"q"==_[4])return i;continue}return i}}return 0}var T=[16,-16,1,-1,15,17,-15,-17];let K=[[],T,[],[33,31,18,14,-33,-31,-18,-14],[15,17,-15,-17],[16,-16,1,-1],T];function w(_,e){for(let t=$;t>=1;t--){let n=t|e<<3;if(2==t){let o=16*(1-2*e);for(let i=-1;i<=1;i+=2){let f=_+o+i;if(!(136&f)&&u[f]==r[n])return!0}}else{let a=4&t,c=K[t];for(let l=0;l<c.length;l++){let s=_;do{if(136&(s+=c[l]))break;let p=u[s];if(0!=p){if(p==r[n])return!0;break}}while(a)}}}return!1}function S(_,$,e,t,n,r,o){return _|$<<7|e<<14|t<<18|n<<19|r<<20|o<<21}function H(_){return 127&_}function N(_){return _>>7&127}function I(_){return _>>14&15}function M(_){return _>>18&1}function q(_){return _>>19&1}function F(_){return _>>20&1}function R(_){return _>>21&1}let D=[96,16],G=[0,112],y=[[1,2],[4,8],],L=[7,15,15,15,3,15,15,11,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,13,13,13,13,13,13,13,13,13,15,15,15,12,15,15,14,13,13,13,13,13,13,13,13,];function O(_,$){let e=0;M($)?(e=_0[13*u[H($)]+u[N($)]],e+=1e4):e=_f[m]==$?9e3:_f[_3+m]==$?8e3:_4[128*u[H($)]+N($)],_.push({move:$,score:e})}function Q(t){for(let n=e;n<=12;n++)for(let i=0;i<d[n];i++){let f=d.pieces[10*n+i],a=o[u[f]],p=7&a;if(_[8&a]==c){if(2==p){let h=-16*(1-2*c),g=f+h;if((136&g)==0&&0==u[g]){if((240&g)==G[c])for(let m=$;m>=3;m--)O(t,S(f,g,r[m|c<<3],0,0,0,0));else{O(t,S(f,g,0,0,0,0,0));let b=f+2*h;(240&f)==D[c]&&0==u[b]&&O(t,S(f,b,0,0,1,0,0))}}for(let k=-1;k<=1;k+=2){if(136&(g=f+h+k))continue;let C=o[u[g]];if(0!=C&&_[8&C]!=c){if((240&g)==G[c])for(let A=$;A>=3;A--)O(t,S(f,g,r[A|c<<3],1,0,0,0));else O(t,S(f,g,0,1,0,0,0))}g==l&&O(t,S(f,g,0,1,0,1,0))}}else if(1==p){let x=v[c];s&y[c][0]&&0==u[x+1]&&0==u[x+2]&&0==w(x,1-c)&&0==w(x+1,1-c)&&O(t,S(x,x+2,0,0,0,0,1)),s&y[c][1]&&0==u[x-1]&&0==u[x-2]&&0==u[x-3]&&0==w(x,1-c)&&0==w(x-1,1-c)&&O(t,S(x,x-2,0,0,0,0,1))}if(2!=p){let E=4&p,P=K[p];for(let B=0;B<P.length;B++){let T=f;do{if(136&(T+=P[B]))break;let H=o[u[T]];if(0!=H){_[8&H]!=c&&O(t,S(f,T,0,1,0,0,0));break}O(t,S(f,T,0,0,0,0,0))}while(E)}}}}}function W(_,$,e){u[e]=u[$],u[$]=0,h^=A[128*_+$],h^=A[128*_+e];for(let t=0;t<d[_];t++)if(d.pieces[10*_+t]==$){d.pieces[10*_+t]=e;break}}function j(_,$){for(let e=0;e<d[_];e++)if(d.pieces[10*_+e]==$){var t=e;break}d[_]--,d.pieces[10*_+t]=d.pieces[10*_+d[_]]}function z(_,$){u[$]=_,h^=A[128*_+$],d.pieces[10*_+d[_]]=$,d[_]++}function U(_){m++,_a[++b]=h;let $=H(_),t=N(_),n=I(_),r=u[t];if(g.push({move:_,capturedPiece:0,side:c,enpassant:l,castle:s,fifty:p,hash:h}),W(u[$],$,t),p++,M(_)?(r&&(g[g.length-1].capturedPiece=r,h^=A[128*r+t],j(r,t)),p=0):(u[t]==e||7==u[t])&&(p=0),120!=l&&(h^=A[l]),l=120,q(_))0==c?(l=t+16,h^=A[t+16]):(l=t-16,h^=A[t-16]);else if(F(_))0==c?(u[t+16]=0,h^=A[896+t+16],j(7,t+16)):(u[t-16]=0,h^=A[128*e+(t-16)],j(e,t-16));else if(R(_))switch(t){case 118:W(4,119,117);break;case 114:W(4,112,115);break;case 6:W(10,7,5);break;case 2:W(10,0,3)}return(n&&(0==c?(h^=A[128*e+t],j(e,t)):(h^=A[896+t],j(7,t)),z(n,t)),(6==u[t]||12==u[t])&&(v[c]=t),h^=x[s],s&=L[$],s&=L[t],h^=x[s],c^=1,h^=f,w(v[1^c],c))?(V(),0):1}function V(){m--,b--;let _=g.length-1,$=g[_].move,t=H($),n=N($);if(W(u[n],n,t),M($)&&z(g[_].capturedPiece,n),F($))0==c?z(e,n-16):z(7,n+16);else if(R($))switch(n){case 118:W(4,117,119);break;case 114:W(4,115,112);break;case 6:W(10,5,7);break;case 2:W(10,3,0)}else I($)&&(0==c?z(7,t):z(e,t),j(I($),t));(6==u[t]||12==u[t])&&(v[1^c]=t),c=g[_].side,l=g[_].enpassant,s=g[_].castle,h=g[_].hash,p=g[_].fifty,g.pop()}var Z=0;function J(_){if(0==_){Z++;return}let $=[];Q($);for(var e=0;e<$.length;e++)U($[e].move)&&(J(_-1),V())}let X=[[0,89,308,319,488,888,20001,-92,-307,-323,-492,-888,-20002],[0,96,319,331,497,853,19998,-102,-318,-334,-501,-845,-2e4],],Y=[[[0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,-4,68,61,47,47,49,45,-1,13,13,13,13,13,13,13,13,6,16,25,33,24,24,14,-6,13,13,13,13,13,13,13,13,0,-1,9,28,20,8,-1,11,13,13,13,13,13,13,13,13,6,4,6,14,14,-5,6,-6,13,13,13,13,13,13,13,13,-1,-8,-4,4,2,-12,-1,5,13,13,13,13,13,13,13,13,5,16,16,-14,-14,13,15,8,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,],[-55,-40,-30,-28,-26,-30,-40,-50,13,13,13,13,13,13,13,13,-37,-15,0,-6,4,3,-17,-40,13,13,13,13,13,13,13,13,-25,5,16,12,11,6,6,-29,13,13,13,13,13,13,13,13,-24,5,21,14,18,9,11,-26,13,13,13,13,13,13,13,13,-36,-5,9,23,24,21,2,-24,13,13,13,13,13,13,13,13,-32,-1,4,19,20,4,11,-25,13,13,13,13,13,13,13,13,-38,-22,4,-1,8,-5,-18,-34,13,13,13,13,13,13,13,13,-50,-46,-32,-24,-36,-25,-34,-50,13,13,13,13,13,13,13,13,],[-16,-15,-12,-5,-10,-12,-10,-20,13,13,13,13,13,13,13,13,-13,5,6,1,-6,-5,3,-6,13,13,13,13,13,13,13,13,-16,6,-1,16,7,-1,-6,-5,13,13,13,13,13,13,13,13,-14,-1,11,14,4,10,11,-13,13,13,13,13,13,13,13,13,-4,5,12,16,4,6,2,-16,13,13,13,13,13,13,13,13,-15,4,14,8,16,4,16,-15,13,13,13,13,13,13,13,13,-5,6,6,6,3,6,9,-7,13,13,13,13,13,13,13,13,-14,-4,-15,-4,-9,-4,-12,-14,13,13,13,13,13,13,13,13,],[5,-2,6,2,-2,-6,4,-2,13,13,13,13,13,13,13,13,8,13,11,15,11,15,16,4,13,13,13,13,13,13,13,13,-6,3,3,6,1,-2,3,-5,13,13,13,13,13,13,13,13,-10,5,-4,-4,-1,-6,3,-2,13,13,13,13,13,13,13,13,-4,3,5,-2,4,1,-5,1,13,13,13,13,13,13,13,13,0,1,1,-3,5,6,1,-9,13,13,13,13,13,13,13,13,-10,-1,-4,0,5,-6,-6,-9,13,13,13,13,13,13,13,13,-1,-2,-6,9,9,5,4,-5,13,13,13,13,13,13,13,13,],[-25,-9,-11,-3,-7,-13,-10,-17,13,13,13,13,13,13,13,13,-4,-6,4,-5,-1,6,4,-5,13,13,13,13,13,13,13,13,-8,-5,2,0,7,6,-4,-5,13,13,13,13,13,13,13,13,0,-4,7,-1,7,11,0,1,13,13,13,13,13,13,13,13,-6,4,7,1,-1,2,-6,-2,13,13,13,13,13,13,13,13,-15,11,11,11,4,11,6,-15,13,13,13,13,13,13,13,13,-5,-6,1,-6,3,-3,3,-10,13,13,13,13,13,13,13,13,-15,-4,-13,-8,-3,-16,-8,-24,13,13,13,13,13,13,13,13,],[-30,-40,-40,-50,-50,-40,-40,-30,13,13,13,13,13,13,13,13,-30,-37,-43,-49,-50,-39,-40,-30,13,13,13,13,13,13,13,13,-32,-41,-40,-46,-49,-40,-46,-30,13,13,13,13,13,13,13,13,-32,-38,-39,-52,-54,-39,-39,-30,13,13,13,13,13,13,13,13,-20,-33,-29,-42,-44,-29,-30,-19,13,13,13,13,13,13,13,13,-10,-18,-17,-20,-22,-21,-20,-13,13,13,13,13,13,13,13,13,14,18,-1,-1,4,-1,15,14,13,13,13,13,13,13,13,13,21,35,11,6,1,14,32,22,13,13,13,13,13,13,13,13,],],[[0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,-4,174,120,94,85,98,68,4,13,13,13,13,13,13,13,13,6,48,44,45,31,38,37,-6,13,13,13,13,13,13,13,13,-6,-4,-1,-6,2,-1,-2,-2,13,13,13,13,13,13,13,13,2,2,5,-3,0,-5,4,-3,13,13,13,13,13,13,13,13,-2,0,1,5,0,-1,0,1,13,13,13,13,13,13,13,13,-2,5,6,-6,0,3,4,-4,13,13,13,13,13,13,13,13,0,0,0,0,0,0,0,0,13,13,13,13,13,13,13,13,],[-50,-40,-30,-24,-24,-35,-40,-50,13,13,13,13,13,13,13,13,-38,-17,6,-5,5,-4,-15,-40,13,13,13,13,13,13,13,13,-24,3,15,9,15,10,-6,-26,13,13,13,13,13,13,13,13,-29,5,21,17,18,9,10,-28,13,13,13,13,13,13,13,13,-36,-5,18,16,14,20,5,-26,13,13,13,13,13,13,13,13,-32,7,5,20,11,15,9,-27,13,13,13,13,13,13,13,13,-43,-20,5,-1,5,1,-22,-40,13,13,13,13,13,13,13,13,-50,-40,-32,-27,-30,-25,-35,-50,13,13,13,13,13,13,13,13,],[-14,-13,-4,-7,-14,-9,-16,-20,13,13,13,13,13,13,13,13,-11,6,3,-6,4,-3,5,-4,13,13,13,13,13,13,13,13,-11,-3,5,15,4,-1,-5,-10,13,13,13,13,13,13,13,13,-7,-1,11,16,5,11,7,-13,13,13,13,13,13,13,13,13,-4,4,10,16,6,12,4,-16,13,13,13,13,13,13,13,13,-4,4,11,12,10,7,7,-12,13,13,13,13,13,13,13,13,-11,7,6,6,-3,2,1,-7,13,13,13,13,13,13,13,13,-15,-4,-11,-4,-10,-10,-6,-17,13,13,13,13,13,13,13,13,],[5,-6,1,-4,-4,-6,6,-3,13,13,13,13,13,13,13,13,-6,4,2,5,-1,3,4,-15,13,13,13,13,13,13,13,13,-15,3,3,0,-1,-6,5,-9,13,13,13,13,13,13,13,13,-16,6,0,-6,-3,-3,-4,-4,13,13,13,13,13,13,13,13,-15,6,2,-6,6,0,-6,-10,13,13,13,13,13,13,13,13,-6,-1,3,-2,6,5,0,-15,13,13,13,13,13,13,13,13,-8,-4,1,-4,3,-5,-6,-5,13,13,13,13,13,13,13,13,1,0,-2,1,1,4,2,0,13,13,13,13,13,13,13,13,],[-21,-7,-6,1,-8,-15,-10,-16,13,13,13,13,13,13,13,13,-4,-5,3,-4,2,6,3,-10,13,13,13,13,13,13,13,13,-13,-2,7,2,6,10,-4,-6,13,13,13,13,13,13,13,13,-1,-4,3,1,8,8,-2,-2,13,13,13,13,13,13,13,13,0,6,8,1,-1,1,0,-3,13,13,13,13,13,13,13,13,-11,10,6,3,7,9,4,-10,13,13,13,13,13,13,13,13,-12,-6,5,0,0,-5,4,-10,13,13,13,13,13,13,13,13,-20,-6,-7,-7,-4,-12,-9,-20,13,13,13,13,13,13,13,13,],[-50,-40,-30,-20,-20,-30,-40,-50,13,13,13,13,13,13,13,13,-30,-18,-15,6,3,-6,-24,-30,13,13,13,13,13,13,13,13,-35,-16,20,32,34,14,-11,-30,13,13,13,13,13,13,13,13,-34,-5,24,35,34,35,-16,-35,13,13,13,13,13,13,13,13,-36,-7,31,34,34,34,-12,-31,13,13,13,13,13,13,13,13,-30,-7,14,33,36,16,-13,-33,13,13,13,13,13,13,13,13,-36,-27,5,2,5,-1,-31,-33,13,13,13,13,13,13,13,13,-48,-26,-26,-26,-28,-25,-30,-51,13,13,13,13,13,13,13,13,],],],__=[112,113,114,115,116,117,118,119,13,13,13,13,13,13,13,13,96,97,98,99,100,101,102,103,13,13,13,13,13,13,13,13,80,81,82,83,84,85,86,87,13,13,13,13,13,13,13,13,64,65,66,67,68,69,70,71,13,13,13,13,13,13,13,13,48,49,50,51,52,53,54,55,13,13,13,13,13,13,13,13,32,33,34,35,36,37,39,40,13,13,13,13,13,13,13,13,16,17,18,19,20,21,22,23,13,13,13,13,13,13,13,13,0,1,2,3,4,5,6,7,13,13,13,13,13,13,13,13,];function _1(){if(0==d[e]&&0==d[7]){if(0==d[4]&&0==d[10]&&0==d[5]&&0==d[11]){if(0==d[3]&&0==d[9]){if(d[t]<3&&d[n]<3)return 1}else if(0==d[t]&&0==d[n]){if(2>Math.abs(d[3]-d[9]))return 1}else if((d[t]<3&&0==d[3]||1==d[3]&&0==d[t])&&(d[n]<3&&0==d[9]||1==d[9]&&0==d[n]))return 1}else if(0==d[5]&&0==d[11]){if(1==d[4]&&1==d[10]){if(d[t]+d[3]<2&&d[n]+d[9]<2)return 1}else if(1==d[4]&&0==d[10]){if(d[t]+d[3]==0&&(d[n]+d[9]==1||d[n]+d[9]==2))return 1}else if(1==d[10]&&0==d[4]&&d[n]+d[9]==0&&(d[t]+d[3]==1||d[t]+d[3]==2))return 1}}return 0}function _$(){if(_1())return 0;let _=function _(){let $=0;for(let e=t;e<=5;e++)$+=d[e]*X[0][e];for(let r=n;r<=11;r++)$+=-(d[r]*X[0][r]);return $}(),$=-1;$=_>5900?0:_<500?1:2;let r=0;var o=0,i=0;for(let f=e;f<=12;f++)for(pieceIndex=0;pieceIndex<d[f];pieceIndex++){let a=d.pieces[10*f+pieceIndex];switch(o+=X[0][f],i+=X[1][f],f){case e:o+=Y[0][0][a],i+=Y[1][0][a];break;case t:o+=Y[0][1][a],i+=Y[1][1][a];break;case 3:o+=Y[0][2][a],i+=Y[1][2][a];break;case 4:o+=Y[0][3][a],i+=Y[1][3][a];break;case 5:o+=Y[0][4][a],i+=Y[1][4][a];break;case 6:o+=Y[0][5][a],i+=Y[1][5][a];break;case 7:o-=Y[0][0][__[a]],i-=Y[1][0][__[a]];break;case n:o-=Y[0][1][__[a]],i-=Y[1][1][__[a]];break;case 9:o-=Y[0][2][__[a]],i-=Y[1][2][__[a]];break;case 10:o-=Y[0][3][__[a]],i-=Y[1][3][__[a]];break;case 11:o-=Y[0][4][__[a]],i-=Y[1][4][__[a]];break;case 12:o-=Y[0][5][__[a]],i-=Y[1][5][__[a]]}}return 2==$?r=(o*_+i*(5900-_))/5900:0==$?r=o:1==$&&(r=i),r=r*(100-p)/100<<0,0==c?r:-r}var _e=838860,_t=[];function _n(){for(var _=0;_<_e;_++)_t[_]={hashKey:0,depth:0,flag:0,score:0,bestMove:0}}function _r(_,$,e,t){var n=_t[(2147483647&h)%_e];_<-_2&&(_-=m),_>_2&&(_+=m),n.hashKey=h,n.score=_,n.flag=t,n.depth=e,n.bestMove=$}let _0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,105,205,305,405,505,605,105,205,305,405,505,605,0,104,204,304,404,504,604,104,204,304,404,504,604,0,103,203,303,403,503,603,103,203,303,403,503,603,0,102,202,302,402,502,602,102,202,302,402,502,602,0,101,201,301,401,501,601,101,201,301,401,501,601,0,100,200,300,400,500,600,100,200,300,400,500,600,0,105,205,305,405,505,605,105,205,305,405,505,605,0,104,204,304,404,504,604,104,204,304,404,504,604,0,103,203,303,403,503,603,103,203,303,403,503,603,0,102,202,302,402,502,602,102,202,302,402,502,602,0,101,201,301,401,501,601,101,201,301,401,501,601,0,100,200,300,400,500,600,100,200,300,400,500,600,],_3=64,_2=48e3;var _o=Array(_3*_3),_i=Array(_3),_f=Array(2*_3),_4=Array(1664),_a=Array(1e3),_u={timeSet:0,stopTime:0,stopped:0,time:-1};function _c(_){_u=_}function _l(){_u={timeSet:0,stopTime:0,stopped:0,time:-1}}function _6(){Z=0,_u.stopped=0,m=0;for(let _=0;_<_o.length;_++)_o[_]=0;for(let $=0;$<_i.length;$++)_i[$]=0;for(let e=0;e<_f.length;e++)_f[e]=0;for(let t=0;t<_4.length;t++)_4[t]=0}function _s(){1==_u.timeSet&&Date.now()>_u.stopTime&&(_u.stopped=1)}function _5(){for(let _=0;_<b;_++)if(_a[_]==h)return 1;return 0}function _p(_,$){for(let e=_+1;e<$.length;e++)if($[_].score<$[e].score){let t=$[_];$[_]=$[e],$[e]=t}}function _7(_,$){for(let e=0;e<_.length;e++)if(_[e].move==$.value){_[e].score=3e4;return}if(m&&a){a=0;for(let t=0;t<_.length;t++)if(_[t].move==_o[m]){a=1,_[t].score=2e4;break}}}function _h(_){_o[64*m+m]=_;for(var $=m+1;$<_i[m+1];$++)_o[64*m+$]=_o[(m+1)*64+$];_i[m]=_i[m+1]}function _v(t,n){if(_i[m]=m,(2047&++Z)==0&&(_s(),1==_u.stopped))return 0;if(m>_3-1)return _$();let i=_$();if(i>=n)return n;i>t&&(t=i);var f=[];!function t(n){for(let i=e;i<=12;i++)for(let f=0;f<d[i];f++){let a=d.pieces[10*i+f],s=o[u[a]],p=7&s;if(_[8&s]==c){if(2==p){let h=-16*(1-2*c),v=a+h;for(let g=-1;g<=1;g+=2){if(136&(v=a+h+g))continue;let m=o[u[v]];if(0!=m&&_[8&m]!=c){if((240&v)==G[c])for(let b=$;b>=3;b--)O(n,S(a,v,r[b|c<<3],1,0,0,0));else O(n,S(a,v,0,1,0,0,0))}v==l&&O(n,S(a,v,0,1,0,1,0))}}if(2!=p){let k=4&p,C=K[p];for(let A=0;A<C.length;A++){let x=a;do{if(136&(x+=C[A]))break;let E=o[u[x]];if(0!=E){_[8&E]!=c&&O(n,S(a,x,0,1,0,0,0));break}}while(k)}}}}}(f),_7(f,{value:0});for(var a=0;a<f.length;a++){_p(a,f);let s=f[a].move;if(0!=U(s)){var p=-_v(-n,-t);if(V(),1==_u.stopped)return 0;if(p>t&&(_h(s),t=p,p>=n))return n}}return t}function _d(_,$,n,r){_i[m]=m;var o={value:0},i=1;let a=0,d=$-_>1,b=0;if(m&&1e5!=(a=function _($,e,t,n){var r=_t[(2147483647&h)%_e];if(r.hashKey==h){if(r.depth>=n){var o=r.score;if(o<-_2&&(o+=m),o>_2&&(o-=m),0==r.flag)return o;if(1==r.flag&&o<=$)return $;if(2==r.flag&&o>=e)return e}t.value=r.bestMove}return 1e5}(_,$,o,n))&&0==d)return a;if((2047&Z)==0&&(_s(),1==_u.stopped)||m&&_5()||p>=100)return 0;if(0==n)return Z++,_v(_,$);if(_<-49e3&&(_=-49e3),$>48999&&($=48999),_>=$)return _;let k=0,C=w(v[c],1^c);if(C&&n++,0==C&&0==d){let x=_$();if(n<3&&Math.abs($-1)>-48900){let E=X[0][e]*n;if(x-E>=$)return x-E}if(r){if(m&&n>2&&x>=$){if(g.push({move:0,capturedPiece:0,side:c,enpassant:l,castle:s,fifty:p,hash:h}),120!=l&&(h^=A[l]),l=120,p=0,c^=1,h^=f,a=-_d(-$,-$+1,n-1-2,0),c=g[g.length-1].side,l=g[g.length-1].enpassant,s=g[g.length-1].castle,p=g[g.length-1].fifty,h=g[g.length-1].hash,g.pop(),1==_u.stopped)return 0;if(a>=$)return $}let P;if((a=x+X[0][e])<$&&1==n)return(P=_v(_,$))>a?P:a;if((a+=X[0][e])<$&&n<4&&(P=_v(_,$))<$)return P>a?P:a}let B=[0,X[0][e],X[0][t],X[0][4],];n<4&&Math.abs(_)<_2&&x+B[n]<=_&&(b=1)}let T=0,K=[];Q(K),_7(K,o);for(let S=0;S<K.length;S++){_p(S,K);let q=K[S].move;if(0!=U(q)){if(k++,b&&T&&0==M(q)&&0==I(q)&&0==w(v[c],1^c)){V();continue}if(0==T?a=-_d(-$,-_,n-1,1):(a=0==d&&T>3&&n>2&&0==C&&(H(q)!=H(_f[m])||N(q)!=N(_f[m]))&&(H(q)!=H(_f[_3+m])||N(q)!=N(_f[_3+m]))&&0==M(q)&&0==I(q)?-_d(-_-1,-_,n-2,1):_+1)>_&&(a=-_d(-_-1,-_,n-1,1))>_&&a<$&&(a=-_d(-$,-_,n-1,1)),V(),T++,1==_u.stopped)return 0;if(a>_&&(i=0,o.value=q,_=a,_h(q),0==M(q)&&(_4[128*u[H(q)]+N(q)]+=n),a>=$))return _r($,o.value,n,2),0==M(q)&&(_f[_3+m]=_f[m],_f[m]=q),$}}return 0==k?C?-49e3+m:0:(_r(_,o.value,n,i),_)}var _g={5:"q",4:"r",3:"b",[t]:"n",11:"q",10:"r",9:"b",[n]:"n"},_m={P:e,N:t,B:3,R:4,Q:5,K:6,p:7,n:n,b:9,r:10,q:11,k:12};let _b=[".","♙","♘","♗","♖","♕","♔","♟","♞","♝","♜","♛","♚",];function _k(_){!function _(){for(var $=0;$<8;$++)for(var e=0;e<16;e++){var t=16*$+e;(136&t)==0&&(u[t]=0)}for(let n in c=-1,l=120,s=0,p=0,h=0,v=[0,0],g=[],m=0,b=0,_a)_a[n]=0}();for(var $=0,e=0;e<8;e++)for(var t=0;t<16;t++){var n=16*e+t;if((136&n)==0){if((_[$].charCodeAt()>="a".charCodeAt()&&_[$].charCodeAt()<="z".charCodeAt()||_[$].charCodeAt()>="A".charCodeAt()&&_[$].charCodeAt()<="Z".charCodeAt())&&("K"==_[$]?v[0]=n:"k"==_[$]&&(v[1]=n),u[n]=_m[_[$]],$++),_[$].charCodeAt()>="0".charCodeAt()&&_[$].charCodeAt()<="9".charCodeAt()){var r=_[$]-"0";!u[n]&&t--,t+=r,$++}"/"==_[$]&&$++}}for(c="w"==_[++$]?0:1,$+=2;" "!=_[$];){switch(_[$]){case"K":s|=1;break;case"Q":s|=2;break;case"k":s|=4;break;case"q":s|=8}$++}if("-"!=_[++$]){var t=_[$].charCodeAt()-"a".charCodeAt(),e=8-(_[$+1].charCodeAt()-"0".charCodeAt());l=16*e+t}else l=120;p=parseInt(_.slice($,_.length-1).split(" ")[1]),b=2*parseInt(_.slice($,_.length+1).split(" ")[2]),h=E(),P()}function _C(_){return I(_)?i[H(_)]+i[N(_)]+_g[I(_)]:i[H(_)]+i[N(_)]}function _A(){for(var _="    Material counts:\n\n",$=e;$<=12;$++)_+="    "+_b[$]+": "+d[$]+"\n";console.log(_);for(var t="    Piece list:\n\n",$=e;$<=12;$++)for(var n=0;n<d[$];n++)t+="    "+_b[$]+": "+i[d.pieces[10*$+n]]+"\n"}return!function _(){for(var $=0;$<1664;$++)A[$]=C();for(var $=0;$<16;$++)x[$]=C();f=C()}(),h=E(),P(),_n(),{VERSION:"1.5a",ELO:"1920",START_FEN:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1 ",COLOR:{WHITE:0,BLACK:1},PIECE:{NO_PIECE:0,WHITE_PAWN:e,WHITE_KNIGHT:t,WHITE_BISHOP:3,WHITE_ROOK:4,WHITE_QUEEN:5,WHITE_KING:6,BLACK_PAWN:7,BLACK_KNIGHT:n,BLACK_BISHOP:9,BLACK_ROOK:10,BLACK_QUEEN:11,BLACK_KING:12},SQUARE:{A8:0,B8:1,C8:2,D8:3,E8:4,F8:5,G8:6,H8:7,A7:16,B7:17,C7:18,D7:19,E7:20,F7:21,G7:22,H7:23,A6:32,B6:33,C6:34,D6:35,E6:36,F6:37,G6:39,H6:40,A5:48,B5:49,C5:50,D5:51,E5:52,F5:53,G5:54,H5:55,A4:64,B4:65,C4:66,D4:67,E4:68,F4:69,G4:70,H4:71,A3:80,B3:81,C3:82,D3:83,E3:84,F3:85,G3:86,H3:87,A2:96,B2:97,C2:98,D2:99,E2:100,F2:101,G2:102,H2:103,A1:112,B1:113,C1:114,D1:115,E1:116,F1:117,G1:118,H1:119},perft:function(_){!function _($){Z=0,console.log("   Performance test:\n"),resultString="";let e=Date.now(),t=[];Q(t);for(var n=0;n<t.length;n++){if(!U(t[n].move))continue;let r=Z;J($-1),V();let o=Z-r;console.log("   move "+(n+1)+(n<9?":  ":": ")+i[H(t[n].move)]+i[N(t[n].move)]+(I(t[n].move)?_g[I(t[n].move)]:" ")+"    nodes: "+o)}resultString+="\n   Depth: "+$,resultString+="\n   Nodes: "+Z,resultString+="\n    Time: "+(Date.now()-e)+" ms\n",console.log(resultString)}(_)},squareToString:function(_){return i[_]},promotedToString:function(_){return _g[_]},printBoard:function(){!function _(){for(var $="",e=0;e<8;e++){for(var t=0;t<16;t++){var n=16*e+t;0==t&&($+="   "+(8-e).toString()+" "),(136&n)==0&&($+=_b[u[n]]+" ")}$+="\n"}$+="     a b c d e f g h",$+="\n\n     Side:     "+(0==c?"white":"black"),$+="\n     Castling:  "+(1&s?"K":"-")+(2&s?"Q":"-")+(4&s?"k":"-")+(8&s?"q":"-"),$+="\n     Ep:          "+(120==l?"no":i[l]),$+="\n\n     Key: "+h,$+="\n 50 rule:          "+p,$+="\n   moves:          "+(b%2?Math.round(b/2)-1:Math.round(b/2)),console.log($+"\n"),_n()}()},setBoard:function(_){_k(_)},generateFen:function(){return function _(){let $=["","P","N","B","R","Q","K","p","n","b","r","q","k",],e="";for(let t=0;t<8;t++){let n=0;for(let r=0;r<16;r++){let o=16*t+r;if((136&o)==0){let i=u[o];0==i&&n++,i&&(e+=(n||"")+$[i],n=0)}}n&&(e+=n),n=0,t<7&&(e+="/")}return e+(" "+(engine.getSide()?"b":"w"))}()},getPiece:function(_){return u[_]},getSide:function(){return c},getFifty:function(){return p},moveFromString:function(_){return B(_)},moveToString:function(_){return _C(_)},moveStack:function(){return g},loadMoves:function(_){!function _($){$=$.split(" ");for(let e=0;e<$.length;e++){let t=$[e];$[e];let n=B(t);n&&U(n)}m=0}(_)},getMoves:function(){return function _(){let $=[];for(let e=0;e<g.length;e++)$.push(_C(g[e].move));return $}()},pgn:function(){return getGamePgn()},getMoveSource:function(_){return H(_)},getMoveTarget:function(_){return N(_)},getMovePromoted:function(_){return I(_)},getMoveCapture:function(_){return M(_)},getMoveCastling:function(_){return R(_)},generateLegalMoves:function(){return function _(){let $=[],e=[];_6(),Q(e);for(let t=0;t<e.length;t++)0!=U(e[t].move)&&($.push(e[t]),V());return $}()},printMoveList:function(_){!function _($){for(var e="   Move     Capture  Double   Enpass   Castling  Score\n\n",t=0;t<$.length;t++){var n=$[t].move;e+="   "+i[H(n)]+i[N(n)],e+=I(n)?_g[I(n)]:" ",e+="    "+M(n)+"        "+q(n)+"        "+F(n)+"        "+R(n)+"         "+$[t].score+"\n"}e+="\n   Total moves: "+$.length,console.log(e)}(_)},resetTimeControl:function(){_l()},setTimeControl:function(_){var $;_u=$=_},getTimeControl:function(){return JSON.parse(JSON.stringify(_u))},search:function(_){return function _($){let e=Date.now(),t=0,n=0;_6();for(let r=1;r<=$&&(n=_o[0],a=1,t=_d(-5e4,5e4,r,1),!(1==_u.stopped||Date.now()>_u.stopTime&&-1!=_u.time));r++){let o="";o=t>=-49e3&&t<=-_2?"info score mate "+parseInt(-(t+49e3)/2-1)+" depth "+r+" nodes "+Z+" time "+(Date.now()-e)+" pv ":t>=_2&&t<=49e3?"info score mate "+parseInt((49e3-t)/2+1)+" depth "+r+" nodes "+Z+" time "+(Date.now()-e)+" pv ":"info score cp "+t+" depth "+r+" nodes "+Z+" time "+(Date.now()-e)+" pv ";for(let i=0;i<_i[0];i++)o+=_C(_o[i])+" ";if(o.includes("mate")||o.includes("-49000"))break}return 1==_u.stopped?n:_o[0]}(_)},searchTime:function(_){_l();let $=new Date().getTime();_u.timeSet=1,_u.time=_,_u.stopTime=$+_u.time,engine.search(64)},isMaterialDraw:function(){return _1()},takeBack:function(){g.length&&V()},isRepetition:function(){return _5()},inCheck:function(_){return w(v[_],1^_)},isSquareAttacked:function(_,$){return w(_,$)},setHashSize:function(_){var $;_t=[],($=_)<4&&($=4),$>128&&($=128),_e=parseInt(1048576*$/20),_n(),console.log("Set hash table size to",$,"Mb"),console.log("Hash table initialized with",_e,"entries")},debug:function(){_k("r3k2r/p1ppqpb1/bn2pnp1/3PN3/1p2P3/2N2Q1p/PPPBBPPP/R3K2R w KQkq - 0 10 "),updateBoard()}}};"undefined"!=typeof exports&&(exports.Engine=Engine);